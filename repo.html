<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="./repo.css">

</head>

<body>
    <header>

    </header>
    <main>
        <style>
        </style>
        <div id="wrapper" class="wrapper">

        </div>
    </main>

    <footer></footer>
    <SCRipt>
        //初始化数据
        var keys = {
            0: { 0: "q", 1: "w", 2: "e", 3: "r", 4: "t", 5: "y", 6: "u", 7: "i", 8: "o", 9: "p", length: 10 },
            //0:["q","w","e","r","t","y","u","i","o","p"],
            1: { 0: "a", 1: "s", 2: "d", 3: "f", 4: "g", 5: "h", 6: "j", 7: "k", 8: "l", length: 9 },
            //1:["a","s","d","f","g","h","j","k","l"],
            2: { 0: "z", 1: "x", 2: "c", 3: "v", 4: "b", 5: "n", 6: "m", length: 7 },
            //2:["z","x","c","v","b","n","m"],
            length: 3
        }//每行之后都加了一个分号:错误，应该是加逗号，如果数组中有数组的话，数组中的每一项
        //是要用逗号隔开的，而且最后一项是不要加逗号的，类似的形式是0:，1:,2:,.....
        var hash = {
            'q': "qq.com",
            't': "tianya.com",
            's': "souhu.com",
            'z': "zhihu.com",
            'b': 'bilibili.com'
        }    //每行之后都加了一个分号。
        
                
        var hashInLocalStorage = JSON.parse(localStorage.getItem('zzz') || 'null');
        if (hashInLocalStorage) {
            hash = hashInLocalStorage;
        }        
        //生成键盘；
     
        for(var index = 0;index < keys['length'];index = index+1){
            //生成块;
            var div = c("div");//document的d大写了。
            div.className = "align";
            wrapper.appendChild(div);

            rows = keys[index];
            //for循环中是不能有间隙的，傲娇
            for(var index2 = 0;index2 < rows['length'];index2 = index2+1){
                //生成span;
                var span = c("span");
                span.textContent = rows[index2];
                //生成kbd;
                var kbd = c("kbd");
                kbd.className = "keys";
                //生成button;
                
                creatButton(rows[index2]);
                //生成img; 
                creatImg(hash[rows[index2]])

                kbd.appendChild(span)
             
                div.appendChild(kbd);
                
            }
        }
        //keys['length']=keys.length;
        
        //监听键盘事件；
        document.onkeypress = function (xzkjcnalkcjlk) {

            var key = xzkjcnalkcjlk["key"];//表示的是输入的键盘值；
            var website = hash[key];
            //location.href = "http://"+website;
            window.open("http://" + website, '_blank')
        }
        //工具函数
        function c(name) {
            return document.createElement(name)
        }

        function creatButton(nature){
            var button = c("button");
            kbd.appendChild(button);
                button.id = nature;
                button.textContent = '编辑';
                button.onclick = function (yueieiefs) {

                    var find = yueieiefs['target']['id'];
                    var button1 = yueieiefs['target'];
                    var img2 = button1.nextSibling;
                    console.log(img2);
                    var x = prompt("请输入一个网址");
                    hash[find] = x;
                    localStorage.setItem('zzz', JSON.stringify(hash))
                    img2.src = "http://"+ x + "/favicon.ico";
                    img2.onerror = function (xxxx) {
                    xxxx['target']["src"] = "https://i.loli.net/2018/04/26/5ae192faca3f2.jpg";
                }
                }
                return button;
        }
        function creatImg(domain){
                var img = c("img");
                kbd.appendChild(img);
                if (domain) {
                    img.src = 'http://' + domain + '/favicon.ico';
                } else {
                    img.src = "https://i.loli.net/2018/04/26/5ae192faca3f2.jpg";
                }
                //怎样监听图片失效
                img.onerror = function (xxxx) {
                    xxxx['target']["src"] = "https://i.loli.net/2018/04/26/5ae192faca3f2.jpg";
                }
                return img;
                }
    </SCRipt>
</body>
</html>